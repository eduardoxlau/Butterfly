{"ast":null,"code":"var _jsxFileName = \"/Users/rafaelsanchez/bytecore/Butterfly/packages/front/src/pages/survey/Form/index.tsx\",\n  _s = $RefreshSig$();\nimport { useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { fetchApi } from \"../../../utils/fetch\";\nimport useFetch from \"../../../utils/useFetch\";\nimport { Span } from \"../../home/styled\";\nimport { HeaderContent } from \"../Header\";\nimport { Question } from \"../Question\";\nimport { Arrow, Card } from \"../Question/styled\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Form = () => {\n  _s();\n  var _feedback$answers;\n  let navigate = useNavigate();\n  let {\n    id\n  } = useParams();\n  const [moodId, setMoodId] = useState(Number(id));\n  const [feedback, setFeedback] = useState({\n    extraComment: \"\",\n    answers: []\n  });\n  const {\n    response: questions\n  } = useFetch({\n    url: `/api?v=${moodId}`\n  });\n  const updateAnswer = input => {\n    const answers = (feedback === null || feedback === void 0 ? void 0 : feedback.answers) || [];\n    const answerIndex = answers.findIndex(answer => input.questionId === answer.questionId);\n    if (answerIndex >= 0) answers[answerIndex] = input;else answers.push(input);\n    setFeedback(oldFeedback => ({\n      ...oldFeedback,\n      answers\n    }));\n  };\n  const onSubmit = async () => {\n    try {\n      await fetchApi({\n        method: \"POST\",\n        data: feedback,\n        url: \"/api/feedback\"\n      });\n      navigate(\"/confirmation\");\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const isFilled = ((_feedback$answers = feedback.answers) === null || _feedback$answers === void 0 ? void 0 : _feedback$answers.length) === 5;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(HeaderContent, {\n      setMood: setMoodId\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Span, {\n      color: \"#ffffff\",\n      fontSize: \"1.2rem\",\n      margin: \"1.5rem 0rem\",\n      children: \"Do you agree with the following statements:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this), questions === null || questions === void 0 ? void 0 : questions.map((question, index) => /*#__PURE__*/_jsxDEV(Question, {\n      question: question,\n      index: index + 1,\n      onChange: updateAnswer\n    }, question.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card, {\n      color: \"#22828E\",\n      children: [/*#__PURE__*/_jsxDEV(Arrow, {\n        color: \"#22828E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"optional-comment\",\n        children: [/*#__PURE__*/_jsxDEV(Span, {\n          color: \"#fff\",\n          fontSize: \"1.5rem\",\n          margin: \"1rem 0\",\n          children: \"Anything to add? (Optional)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"extra-help\",\n          children: \"Extra feedback helps\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        name: \"extraComment\",\n        onChange: event => setFeedback(oldFeedback => ({\n          ...oldFeedback,\n          extraComment: event.target.value\n        }))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: isFilled ? \"\" : \"disabled\",\n      disabled: !isFilled,\n      onClick: onSubmit,\n      children: \"Send\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Form, \"djBMtzPIw+kb9mzdv4syVFHQdCY=\", false, function () {\n  return [useNavigate, useParams, useFetch];\n});\n_c = Form;\nvar _c;\n$RefreshReg$(_c, \"Form\");","map":{"version":3,"names":["useState","useNavigate","useParams","fetchApi","useFetch","Span","HeaderContent","Question","Arrow","Card","Form","navigate","id","moodId","setMoodId","Number","feedback","setFeedback","extraComment","answers","response","questions","url","updateAnswer","input","answerIndex","findIndex","answer","questionId","push","oldFeedback","onSubmit","method","data","error","console","isFilled","length","map","question","index","event","target","value"],"sources":["/Users/rafaelsanchez/bytecore/Butterfly/packages/front/src/pages/survey/Form/index.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { fetchApi } from \"../../../utils/fetch\";\nimport { Answer, Feedback, IQuestion } from \"../../../utils/types\";\nimport useFetch from \"../../../utils/useFetch\";\nimport { Span } from \"../../home/styled\";\nimport { HeaderContent } from \"../Header\";\nimport { Question } from \"../Question\";\nimport { Arrow, Card } from \"../Question/styled\";\n\nexport const Form = () => {\n  let navigate = useNavigate();\n  let { id } = useParams();\n\n  const [moodId, setMoodId] = useState<number>(Number(id));\n\n  const [feedback, setFeedback] = useState<Feedback>({\n    extraComment: \"\",\n    answers: [],\n  });\n\n  const { response: questions }: { response: any } = useFetch({\n    url: `/api?v=${moodId}`,\n  });\n\n  const updateAnswer = (input: Answer) => {\n    const answers = feedback?.answers || [];\n\n    const answerIndex = answers.findIndex(\n      (answer) => input.questionId === answer.questionId\n    );\n\n    if (answerIndex >= 0) answers[answerIndex] = input;\n    else answers.push(input);\n\n    setFeedback((oldFeedback) => ({ ...oldFeedback, answers }));\n  };\n\n  const onSubmit = async () => {\n    try {\n      await fetchApi({ method: \"POST\", data: feedback, url: \"/api/feedback\" });\n      navigate(\"/confirmation\");\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const isFilled = feedback.answers?.length === 5;\n\n  return (\n    <>\n      <HeaderContent setMood={setMoodId} />\n      <Span color=\"#ffffff\" fontSize=\"1.2rem\" margin=\"1.5rem 0rem\">\n        Do you agree with the following statements:\n      </Span>\n      {questions?.map((question: IQuestion, index: number) => (\n        <Question\n          key={question.id}\n          question={question}\n          index={index + 1}\n          onChange={updateAnswer}\n        />\n      ))}\n      <br />\n      <Card color=\"#22828E\">\n        <Arrow color=\"#22828E\" />\n        <div className=\"optional-comment\">\n          <Span color=\"#fff\" fontSize=\"1.5rem\" margin=\"1rem 0\">\n            Anything to add? (Optional)\n          </Span>\n          <div className=\"extra-help\">Extra feedback helps</div>\n        </div>\n\n        <textarea\n          name=\"extraComment\"\n          onChange={(event) =>\n            setFeedback((oldFeedback) => ({\n              ...oldFeedback,\n              extraComment: event.target.value,\n            }))\n          }\n        ></textarea>\n      </Card>\n      <br />\n      <button\n        className={isFilled ? \"\" : \"disabled\"}\n        disabled={!isFilled}\n        onClick={onSubmit}\n      >\n        Send\n      </button>\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}